ggplot(data.frame(copSim), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(copSim), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
library(MASS)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
install.packages('plot3d')
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
install.packages('plot3d')
library(MASS)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
install.packages('plot3D')
library(MASS)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
library(plot3D)
persp(pmvnorm(n=700, mu=X_bar, Sigma = S))
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
library(plot3D)
set.seed(100)
X_bar = matrix(c(2,3), nrow=2)
S = matrix(c(2,-1,-1,2), nrow=2, ncol=2, byrow=TRUE)
normVals = mvrnorm(n=700, mu=X_bar, Sigma = S)
var(normVals)
cor(normVals)
ggplot(data.frame(normVals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated Normal Values with mu = 2, var = 2') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,70), xlim = c(-3,8))
ggplot(data.frame(normVals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated Normal Values with mu = 3, var = 2') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,70), xlim = c(-3,8))
ggpairs(data.frame(normVals))
pvals = cbind(pnorm(normVals[,1], mean=2, sd=sqrt(2)), pnorm(normVals[,2], mean=3, sd=sqrt(2)))
ggplot(data.frame(pvals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using pnorm') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(pvals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using pnorm') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggpairs(data.frame(pvals))
epvals = cbind(pobs(normVals[,1]),pobs(normVals[,2]))
ggplot(data.frame(epvals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Cumulative Density Estimation') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(epvals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Cumulative Density Estimation') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
tmp = BiCopSelect(pvals[,1],pvals[,2])
summary(tmp)
tmp = BiCopSelect(epvals[,1],epvals[,2])
summary(tmp)
normCop = normalCopula(dim=2)
copFit = fitCopula(normCop,as.matrix(pvals))
copFit
copSim = rCopula(n=500, normalCopula(param=coef(copFit),dim=2))
cov(copSim)
cor(copSim)
ggplot(data.frame(copSim), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(copSim), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
persp(kde2d(cop_x1, cop_x2))
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
persp(kde2d(cop_x1, cop_x2), col = 'blue')
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
kde2d(cop_x1, cop_x2)
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
cop3D = kde2d(cop_x1, cop_x2)
sim3D =
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
cop3D = kde2d(cop_x1, cop_x2)
sim3D = data.frame(x1 = cop_x1, x2 = cop_x2, z = dmvnorm(x = cbind(cop_x1, cop_x2), mu - X_bar, Sigma=S))
library(MASS)
library(mvtnorm)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
library(plot3D)
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
cop3D = kde2d(cop_x1, cop_x2)
sim3D = data.frame(x1 = cop_x1, x2 = cop_x2, z = dmvnorm(x = cbind(cop_x1, cop_x2), mu - X_bar, Sigma=S))
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
cop3D = kde2d(cop_x1, cop_x2)
sim3D = data.frame(x1 = cop_x1, x2 = cop_x2, z = dmvnorm(x = cbind(cop_x1, cop_x2), mu - X_bar, sigma=S))
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
cop3D = kde2d(cop_x1, cop_x2)
sim3D = data.frame(x1 = cop_x1, x2 = cop_x2, z = dmvnorm(x = cbind(cop_x1, cop_x2), mean = X_bar, sigma=S))
persp(sim3D)
View(sim3D)
View(cop3D)
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
cop3D = kde2d(cop_x1, cop_x2)
sim3D = data.frame(x = cop_x1, y = cop_x2, z = dmvnorm(x = cbind(cop_x1, cop_x2), mean = X_bar, sigma=S))
persp(sim3D)
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
cop3D = kde2d(cop_x1, cop_x2)
sim3D = kde2d(normVals[,1], normVals[,2])
persp(sim3D)
persp(cop3D)
persp(cop3D, theta = 60)
persp(cop3D, theta = 70)
persp(cop3D, theta = 10)
persp(cop3D, theta = -10)
persp(cop3D, theta = -20)
persp(cop3D, theta = -50)
persp(cop3D, theta = -30)
persp(cop3D, theta = 80)
persp(cop3D, theta = 90)
persp(cop3D, theta = 150)
persp(cop3D, phi = 150)
persp(cop3D, theta = 150)
persp(cop3D, theta = 70)
persp(cop3D, theta = 40)
persp(cop3D, theta = 0)
persp(cop3D, theta = 10)
persp(cop3D, theta = -20)
persp(cop3D, theta = -50)
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
data.frame(x1 = c(normVals[,1] ,cop_x1), x2 = c(normVals[,2] ,cop_x2), Source = c(rep('Simulated', 500), rep('Copula', 500)))
copSim = rCopula(n=700, normalCopula(param=coef(copFit),dim=2))
cov(copSim)
cor(copSim)
ggplot(data.frame(copSim), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(copSim), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
data.frame(x1 = c(normVals[,1] ,cop_x1), x2 = c(normVals[,2] ,cop_x2), Source = c(rep('Simulated', 700), rep('Copula', 700)))
ggplot(simData, aes(x = x1, y = x2, color = Source)) +
geom_point()
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
simData = data.frame(x1 = c(normVals[,1] ,cop_x1), x2 = c(normVals[,2] ,cop_x2), Source = c(rep('Simulated', 700), rep('Copula', 700)))
ggplot(simData, aes(x = x1, y = x2, color = Source)) +
geom_point()
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
simData = data.frame(x1 = c(normVals[,1] ,cop_x1), x2 = c(normVals[,2] ,cop_x2), Source = c(rep('Bivariate Normal Simulated', 700), rep('Copula Simulated', 700)))
ggplot(simData, aes(x = x1, y = x2, color = Source)) +
geom_point()
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
simData = data.frame(x1 = c(normVals[,1] ,cop_x1), x2 = c(normVals[,2] ,cop_x2), Source = c(rep('Normal Simulated', 700), rep('Copula Simulated', 700)))
ggplot(simData, aes(x = x1, y = x2, color = Source)) +
geom_point()
ggplot(simData, aes(x = x1, y = x2, color = Source)) +
geom_point() +
ggtitle('Distribution of Simulated Data from Bivariate Normal and Copula')
library(MASS)
library(mvtnorm)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
library(plot3D)
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(mvtnorm)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
library(plot3D)
set.seed(100)
X_bar = matrix(c(2,3), nrow=2)
S = matrix(c(2,-1,-1,2), nrow=2, ncol=2, byrow=TRUE)
normVals = mvrnorm(n=700, mu=X_bar, Sigma = S)
var(normVals)
cor(normVals)
ggplot(data.frame(normVals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated Normal Values with mu = 2, var = 2') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,70), xlim = c(-3,8))
ggplot(data.frame(normVals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated Normal Values with mu = 3, var = 2') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,70), xlim = c(-3,8))
ggpairs(data.frame(normVals))
pvals = cbind(pnorm(normVals[,1], mean=2, sd=sqrt(2)), pnorm(normVals[,2], mean=3, sd=sqrt(2)))
ggplot(data.frame(pvals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using pnorm') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(pvals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using pnorm') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggpairs(data.frame(pvals))
epvals = cbind(pobs(normVals[,1]),pobs(normVals[,2]))
ggplot(data.frame(epvals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Cumulative Density Estimation') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(epvals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Cumulative Density Estimation') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
tmp = BiCopSelect(pvals[,1],pvals[,2])
summary(tmp)
tmp = BiCopSelect(epvals[,1],epvals[,2])
summary(tmp)
normCop = normalCopula(dim=2)
copFit = fitCopula(normCop,as.matrix(pvals))
copFit
copSim = rCopula(n=700, normalCopula(param=coef(copFit),dim=2))
cov(copSim)
cor(copSim)
ggplot(data.frame(copSim), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(copSim), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
simData = data.frame(x1 = c(normVals[,1] ,cop_x1), x2 = c(normVals[,2] ,cop_x2), Source = c(rep('Normal Simulated', 700), rep('Copula Simulated', 700)))
ggplot(simData, aes(x = x1, y = x2, color = Source)) +
geom_point() +
ggtitle('Distribution of Simulated Data from Bivariate Normal and Copula')
library(MASS)
library(mvtnorm)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
library(plot3D)
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(mvtnorm)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
library(plot3D)
set.seed(100)
X_bar = matrix(c(2,3), nrow=2)
S = matrix(c(2,-1,-1,2), nrow=2, ncol=2, byrow=TRUE)
normVals = mvrnorm(n=700, mu=X_bar, Sigma = S)
var(normVals)
cor(normVals)
ggplot(data.frame(normVals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated Normal Values with mu = 2, var = 2') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,70), xlim = c(-3,8))
ggplot(data.frame(normVals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated Normal Values with mu = 3, var = 2') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,70), xlim = c(-3,8))
ggpairs(data.frame(normVals))
pvals = cbind(pnorm(normVals[,1], mean=2, sd=sqrt(2)), pnorm(normVals[,2], mean=3, sd=sqrt(2)))
ggplot(data.frame(pvals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using pnorm') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(pvals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using pnorm') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggpairs(data.frame(pvals))
epvals = cbind(pobs(normVals[,1]),pobs(normVals[,2]))
ggplot(data.frame(epvals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Cumulative Density Estimation') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(epvals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Cumulative Density Estimation') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
tmp = BiCopSelect(pvals[,1],pvals[,2])
summary(tmp)
tmp = BiCopSelect(epvals[,1],epvals[,2])
summary(tmp)
normCop = normalCopula(dim=2)
copFit = fitCopula(normCop,as.matrix(pvals))
copFit
copSim = rCopula(n=700, normalCopula(param=coef(copFit),dim=2))
cov(copSim)
cor(copSim)
ggplot(data.frame(copSim), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(copSim), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
simData = data.frame(x1 = c(normVals[,1] ,cop_x1), x2 = c(normVals[,2] ,cop_x2), Source = c(rep('Bivariate Normal', 700), rep('Gaussian Copula', 700)))
ggplot(simData, aes(x = x1, y = x2, color = Source)) +
geom_point() +
ggtitle('Distribution of Simulated Data from Bivariate Normal and Copula')
ggplot(simData, aes(x = x1, y = x2, color = Source)) +
geom_point() +
ggtitle('Distribution of Simulated Data from Bivariate Normal and Gaussian Copula')
pobs(c(1,2,7,8,10,10))
1/7
1/7
2/7
1/7
2/7
3/7
1/7
2/7
3/7
5/7
1/7
2/7
3/7
4/7
5/7
6/7
1/7
2/7
3/7
4/7
5.5/7
5.5/7
1/7
2/7
3/7
4/7
5.5/7
5.5/7
6/7
pobs(c(1,2,7,8,10,10,10))
pobs(c(1,2,7,10,10,10))
1/7
2/7
3/7
4/7
5/7
5/7
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(mvtnorm)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
library(plot3D)
cite(copula)
cite('copula')
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
library(mvtnorm)
library(plotly)
library(copula)
library(VineCopula)
library(ggplot2)
library(GGally)
library(plot3D)
set.seed(100)
X_bar = matrix(c(2,3), nrow=2)
S = matrix(c(2,-1,-1,2), nrow=2, ncol=2, byrow=TRUE)
normVals = mvrnorm(n=700, mu=X_bar, Sigma = S)
var(normVals)
cor(normVals)
ggplot(data.frame(normVals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated Normal Values with mu = 2, var = 2') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,70), xlim = c(-3,8))
ggplot(data.frame(normVals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated Normal Values with mu = 3, var = 2') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,70), xlim = c(-3,8))
ggpairs(data.frame(normVals))
pvals = cbind(pnorm(normVals[,1], mean=2, sd=sqrt(2)), pnorm(normVals[,2], mean=3, sd=sqrt(2)))
ggplot(data.frame(pvals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using pnorm') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(pvals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using pnorm') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggpairs(data.frame(pvals))
epvals = cbind(pobs(normVals[,1]),pobs(normVals[,2]))
ggplot(data.frame(epvals), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Cumulative Density Estimation') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(epvals), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Cumulative Density Estimation') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
tmp = BiCopSelect(pvals[,1],pvals[,2])
summary(tmp)
tmp = BiCopSelect(epvals[,1],epvals[,2])
summary(tmp)
normCop = normalCopula(dim=2)
copFit = fitCopula(normCop,as.matrix(pvals))
copFit
copSim = rCopula(n=700, normalCopula(param=coef(copFit),dim=2))
cov(copSim)
cor(copSim)
ggplot(data.frame(copSim), aes(x=X1)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X1) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
ggplot(data.frame(copSim), aes(x=X2)) +
geom_histogram(bins=30, color = 'darkorchid3', fill = 'orchid3') +
ggtitle('Histogram of Simulated F(X2) Values Using Gaussian Copula') +
ylab('Frequency') +
coord_cartesian(ylim = c(0,40))
cop_x1 = qnorm(copSim[,1], mean = 2, sd = sqrt(2))
cop_x2 = qnorm(copSim[,2], mean = 3, sd = sqrt(2))
simData = data.frame(x1 = c(normVals[,1] ,cop_x1), x2 = c(normVals[,2] ,cop_x2), Source = c(rep('Bivariate Normal', 700), rep('Gaussian Copula', 700)))
colMeans(simData)
View(simData)
colMeans(cbind(cop_x1,cop_x2))
var(cbind(cop_x1, cop_x2))
